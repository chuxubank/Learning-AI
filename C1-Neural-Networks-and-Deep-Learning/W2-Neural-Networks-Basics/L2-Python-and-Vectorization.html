<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Python and Vectorization | Learning AI</title>
    <meta name="description" content="Notes in learning AI">
    
    
    <link rel="preload" href="/Learning-AI/assets/css/0.styles.e5d65843.css" as="style"><link rel="preload" href="/Learning-AI/assets/js/app.4bfd347d.js" as="script"><link rel="preload" href="/Learning-AI/assets/js/2.8ff365d0.js" as="script"><link rel="preload" href="/Learning-AI/assets/js/12.3dfda11e.js" as="script"><link rel="prefetch" href="/Learning-AI/assets/js/10.b5b777b1.js"><link rel="prefetch" href="/Learning-AI/assets/js/11.5044d44d.js"><link rel="prefetch" href="/Learning-AI/assets/js/13.f7686d83.js"><link rel="prefetch" href="/Learning-AI/assets/js/14.07a04a90.js"><link rel="prefetch" href="/Learning-AI/assets/js/15.0ce5b44a.js"><link rel="prefetch" href="/Learning-AI/assets/js/3.13823d5a.js"><link rel="prefetch" href="/Learning-AI/assets/js/4.4f27a70f.js"><link rel="prefetch" href="/Learning-AI/assets/js/5.084cf406.js"><link rel="prefetch" href="/Learning-AI/assets/js/6.e67d83eb.js"><link rel="prefetch" href="/Learning-AI/assets/js/7.eccc1a60.js"><link rel="prefetch" href="/Learning-AI/assets/js/8.cb7170da.js"><link rel="prefetch" href="/Learning-AI/assets/js/9.da10128c.js">
    <link rel="stylesheet" href="/Learning-AI/assets/css/0.styles.e5d65843.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Learning-AI/" class="home-link router-link-active"><!----> <span class="site-name">Learning AI</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Learning-AI/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">deeplearning.ai</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Learning-AI/C1-Neural-Networks-and-Deep-Learning/" class="nav-link router-link-active">Neural Networks and Deep Learning</a></li><li class="dropdown-item"><!----> <a href="/Learning-AI/Improving Deep Neural Networks/" class="nav-link">Improving Deep Neural Networks</a></li><li class="dropdown-item"><!----> <a href="/Learning-AI/Structuring Machine Learning Projects/" class="nav-link">Structuring Machine Learning Projects</a></li><li class="dropdown-item"><!----> <a href="/Learning-AI/Convolutional Neural Networks/" class="nav-link">Convolutional Neural Networks</a></li><li class="dropdown-item"><!----> <a href="/Learning-AI/Sequence Models/" class="nav-link">Sequence Models</a></li></ul></div></div> <a href="https://github.com/chuxubank/Learning-AI" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Learning-AI/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">deeplearning.ai</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Learning-AI/C1-Neural-Networks-and-Deep-Learning/" class="nav-link router-link-active">Neural Networks and Deep Learning</a></li><li class="dropdown-item"><!----> <a href="/Learning-AI/Improving Deep Neural Networks/" class="nav-link">Improving Deep Neural Networks</a></li><li class="dropdown-item"><!----> <a href="/Learning-AI/Structuring Machine Learning Projects/" class="nav-link">Structuring Machine Learning Projects</a></li><li class="dropdown-item"><!----> <a href="/Learning-AI/Convolutional Neural Networks/" class="nav-link">Convolutional Neural Networks</a></li><li class="dropdown-item"><!----> <a href="/Learning-AI/Sequence Models/" class="nav-link">Sequence Models</a></li></ul></div></div> <a href="https://github.com/chuxubank/Learning-AI" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Week 1 | Introduction to deep learning</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Week 2 | Neural Networks Basics</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Learning-AI/C1-Neural-Networks-and-Deep-Learning/W2-Neural-Networks-Basics/" class="sidebar-link">About</a></li><li><a href="/Learning-AI/C1-Neural-Networks-and-Deep-Learning/W2-Neural-Networks-Basics/L1-Logistic-Regression-as-a-Neural-Network.html" class="sidebar-link">Logistic Regression as a Neural Network</a></li><li><a href="/Learning-AI/C1-Neural-Networks-and-Deep-Learning/W2-Neural-Networks-Basics/L2-Python-and-Vectorization.html" class="active sidebar-link">Python and Vectorization</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Learning-AI/C1-Neural-Networks-and-Deep-Learning/W2-Neural-Networks-Basics/L2-Python-and-Vectorization.html#vectorization" class="sidebar-link">Vectorization</a></li><li class="sidebar-sub-header"><a href="/Learning-AI/C1-Neural-Networks-and-Deep-Learning/W2-Neural-Networks-Basics/L2-Python-and-Vectorization.html#more-vectorization-examples" class="sidebar-link">More Vectorization Examples</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Learning-AI/C1-Neural-Networks-and-Deep-Learning/W2-Neural-Networks-Basics/L2-Python-and-Vectorization.html#neural-network-programming-guideline" class="sidebar-link">Neural network programming guideline</a></li><li class="sidebar-sub-header"><a href="/Learning-AI/C1-Neural-Networks-and-Deep-Learning/W2-Neural-Networks-Basics/L2-Python-and-Vectorization.html#vectors-and-matrix-valued-functions" class="sidebar-link">Vectors and matrix valued functions</a></li><li class="sidebar-sub-header"><a href="/Learning-AI/C1-Neural-Networks-and-Deep-Learning/W2-Neural-Networks-Basics/L2-Python-and-Vectorization.html#logistic-regression-derivatives" class="sidebar-link">Logistic regression derivatives</a></li></ul></li></ul></li></ul></section></li><li><a href="/Learning-AI/C1-Neural-Networks-and-Deep-Learning/Practice-Questions.html" class="sidebar-link">Practice Questions</a></li><li><a href="/Learning-AI/C1-Neural-Networks-and-Deep-Learning/Heroes-of-Deep-Learning.html" class="sidebar-link">Heroes of Deep Learning</a></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="python-and-vectorization"><a href="#python-and-vectorization" aria-hidden="true" class="header-anchor">#</a> Python and Vectorization</h1> <h2 id="vectorization"><a href="#vectorization" aria-hidden="true" class="header-anchor">#</a> Vectorization</h2> <p>Vectorization is basically the art of getting rid of explicit folders in your code.</p> <p>When compute <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">z=w^Tx+b</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.924661em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mo>=</mo><mo>[</mo><mi mathvariant="normal">⋮</mi><mrow></mrow><mo>]</mo><mo separator="true">,</mo><mi>x</mi><mo>=</mo><mo>[</mo><mi mathvariant="normal">⋮</mi><mrow></mrow><mo>]</mo><mo separator="true">;</mo><mi>w</mi><mo separator="true">,</mo><mi>x</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><msub><mi>n</mi><mi>x</mi></msub></msup></mrow><annotation encoding="application/x-tex">w=[\vdots], x=[\vdots]; w,x \in \mathbb{R}^{n_x}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.75em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.75em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span><span class="mclose">]</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> <div class="warning custom-block"><p class="custom-block-title">Non-vectorized</p> <div class="language-python extra-class"><pre class="language-python"><code>z <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_x<span class="token punctuation">)</span><span class="token punctuation">:</span>
	z <span class="token operator">+=</span> w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
z <span class="token operator">+=</span> b
</code></pre></div></div> <div class="tip custom-block"><p class="custom-block-title">Vectorized</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
z <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>w<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">+</span> b
</code></pre></div><p>This <code>numpy</code> built-in function take much better advantage of parallelism to do your computations much faster.</p> <p>Both GPU and CPU have parallelization instructions, aka SIMD (Single Instruction Multiple data).</p></div> <p><a href="https://nbviewer.jupyter.org/github/chuxubank/Learning-AI/blob/master/C1-Neural-Networks-and-Deep-Learning/W2-Neural-Networks-Basics/L2-Python-and-Vectorization/Vectorization%20demo.ipynb" target="_blank" rel="noopener noreferrer">Demo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="more-vectorization-examples"><a href="#more-vectorization-examples" aria-hidden="true" class="header-anchor">#</a> More Vectorization Examples</h2> <h3 id="neural-network-programming-guideline"><a href="#neural-network-programming-guideline" aria-hidden="true" class="header-anchor">#</a> Neural network programming guideline</h3> <p><em>Whenever possible, avoid explicit for-loops.</em></p> <p>If ever you want to compute <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi><mo>=</mo><mi>A</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">u=Av</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span></p> <div class="warning custom-block"><p class="custom-block-title">Non-vectorized</p> <div class="language-python extra-class"><pre class="language-python"><code>u <span class="token operator">=</span> np<span class="token punctuation">.</span>zero<span class="token punctuation">(</span>n<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
	<span class="token keyword">for</span> j <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
		u<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> v<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
</code></pre></div></div> <div class="tip custom-block"><p class="custom-block-title">Vectorized</p> <div class="language-python extra-class"><pre class="language-python"><code>u <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>A<span class="token punctuation">,</span>v<span class="token punctuation">)</span>
</code></pre></div></div> <h3 id="vectors-and-matrix-valued-functions"><a href="#vectors-and-matrix-valued-functions" aria-hidden="true" class="header-anchor">#</a> Vectors and matrix valued functions</h3> <p>Say you need to <em>apply the exponential operation on every element of a matrix/vector</em>.</p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>v</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>v</mi><mi>n</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo separator="true">,</mo><mi>u</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>e</mi><msub><mi>v</mi><mn>1</mn></msub></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">⋮</mi><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>e</mi><msub><mi>v</mi><mi>n</mi></msub></msup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">v = \begin{bmatrix} v_1 \\ \vdots \\ v_n \end{bmatrix}, u = \begin{bmatrix} e^{v_1} \\ \vdots \\ e^{v_n} \end{bmatrix}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.260000000000001em;vertical-align:-1.8800000000000006em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.351015em;"><span style="top:-1.9499950000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-3.104995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.351015em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.850025em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.3800000000000003em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3674999999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1674999999999995em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.8800000000000006em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.351015em;"><span style="top:-1.9499950000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-3.104995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.351015em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.850025em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.260000000000001em;vertical-align:-1.8800000000000006em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.351015em;"><span style="top:-1.9499950000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-3.104995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.351015em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.850025em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.3800000000000003em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.3674999999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1674999999999995em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.8800000000000006em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.351015em;"><span style="top:-1.9499950000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-3.104995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.351015em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.850025em;"><span></span></span></span></span></span></span></span></span></span></span></p> <div class="warning custom-block"><p class="custom-block-title">Non-vectorized</p> <div class="language-python extra-class"><pre class="language-python"><code>u <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
	u<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> math<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></div> <div class="tip custom-block"><p class="custom-block-title">Vectorized</p> <div class="language-python extra-class"><pre class="language-python"><code>u <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>v<span class="token punctuation">)</span>
</code></pre></div></div> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># other vector value functions in numpy</span>
np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>v<span class="token punctuation">)</span>
np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
np<span class="token punctuation">.</span>maximum<span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
v<span class="token operator">**</span><span class="token number">2</span>	<span class="token comment"># takes the element-wise square of each element of v.</span>
<span class="token number">1</span><span class="token operator">/</span>v 	<span class="token comment"># takes the element-wise inverse</span>
</code></pre></div><h3 id="logistic-regression-derivatives"><a href="#logistic-regression-derivatives" aria-hidden="true" class="header-anchor">#</a> Logistic regression derivatives</h3> <div class="warning custom-block"><p class="custom-block-title">Non-vectorized</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># Pseudocode</span>
J <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> dw1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> dw2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> db <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span> to m<span class="token punctuation">:</span>
	z<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> w_T <span class="token operator">*</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> b
	a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> sigma<span class="token punctuation">(</span>z<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
	J <span class="token operator">+=</span> <span class="token operator">-</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> log<span class="token punctuation">(</span>y_hat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> y_i<span class="token punctuation">)</span> <span class="token operator">*</span> log<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> y_hat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	dz<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
	dw_1 <span class="token operator">+=</span> x_1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> dz<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
	dw_2 <span class="token operator">+=</span> x_2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> dz<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
	db <span class="token operator">+=</span> dz<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
J <span class="token operator">/=</span> m<span class="token punctuation">,</span> dw_1 <span class="token operator">/=</span> m<span class="token punctuation">,</span> dw_2 <span class="token operator">/=</span> m<span class="token punctuation">,</span> db <span class="token operator">/=</span> m

w_1 <span class="token operator">=</span> w1 <span class="token operator">-</span> alpha <span class="token operator">*</span> dw_1
w_1 <span class="token operator">=</span> w1 <span class="token operator">-</span> alpha <span class="token operator">*</span> dw_1
b <span class="token operator">=</span> b <span class="token operator">-</span> alpha <span class="token operator">*</span> db
</code></pre></div></div> <div class="tip custom-block"><p class="custom-block-title">Vectorized</p> <div class="language-python extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><div class="highlighted"> </div><br><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-python"><code><span class="token comment"># Pseudocode</span>
J <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> dw <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>n_x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> db <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span> to m<span class="token punctuation">:</span>
	z<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> w_T <span class="token operator">*</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> b
	a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> sigma<span class="token punctuation">(</span>z<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
	J <span class="token operator">+=</span> <span class="token operator">-</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> log<span class="token punctuation">(</span>y_hat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> y_i<span class="token punctuation">)</span> <span class="token operator">*</span> log<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> y_hat<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	dz<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
	dw <span class="token operator">+=</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> dz<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
	db <span class="token operator">+=</span> dz<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
J <span class="token operator">/=</span> m<span class="token punctuation">,</span> dw <span class="token operator">/=</span> m<span class="token punctuation">,</span> db <span class="token operator">/=</span> m

w_1 <span class="token operator">=</span> w1 <span class="token operator">-</span> alpha <span class="token operator">*</span> dw_1
w_1 <span class="token operator">=</span> w1 <span class="token operator">-</span> alpha <span class="token operator">*</span> dw_1
b <span class="token operator">=</span> b <span class="token operator">-</span> alpha <span class="token operator">*</span> db
</code></pre></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/chuxubank/Learning-AI/edit/master/C1-Neural-Networks-and-Deep-Learning/W2-Neural-Networks-Basics/L2-Python-and-Vectorization.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Learning-AI/C1-Neural-Networks-and-Deep-Learning/W2-Neural-Networks-Basics/L1-Logistic-Regression-as-a-Neural-Network.html" class="prev">
          Logistic Regression as a Neural Network
        </a></span> <span class="next"><a href="/Learning-AI/C1-Neural-Networks-and-Deep-Learning/Practice-Questions.html">
          Practice Questions
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/Learning-AI/assets/js/app.4bfd347d.js" defer></script><script src="/Learning-AI/assets/js/2.8ff365d0.js" defer></script><script src="/Learning-AI/assets/js/12.3dfda11e.js" defer></script>
  </body>
</html>
